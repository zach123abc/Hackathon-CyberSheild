{% extends "base.html" %}

{% block title %}Generate Password{% endblock %}

{% block content %}
<h1>Secure Password Generator</h1>

<form method="post" class="password-form">
  <div class="form-group">
    <label for="length">Password Length:</label>
    <input type="number" id="length" name="length" min="4" max="64" value="12" required>
  </div>

  <div class="form-group checkboxes">
    <label><input type="checkbox" name="letters" checked> Letters (A–Z, a–z)</label>
    <label><input type="checkbox" name="numbers" checked> Numbers (0–9)</label>
    <label><input type="checkbox" name="symbols" checked> Symbols (!@#$...)</label>
  </div>

  <button type="submit" class="btn">Generate Password</button>
</form>

{% if password %}
  <div class="result-box">
    <p><strong>Generated Password:</strong></p>
    <div class="password-display" id="password">{{ password }}</div>
    <button id="copyBtn" class="btn secondary">Copy to Clipboard</button>
    <button id="regenBtn" class="btn secondary">Regenerate</button>
  </div>
{% endif %}

<style>
  h1 {
    text-align: center;
    margin-bottom: 20px;
  }
  .password-form {
    max-width: 400px;
    margin: 0 auto;
    background: #f5f5f5;
    padding: 15px 20px;
    border-radius: 8px;
  }
  .form-group {
    margin-bottom: 15px;
  }
  .form-group input[type="number"] {
    width: 100%;
    padding: 5px;
  }
  .checkboxes label {
    display: block;
    margin-bottom: 5px;
  }
  .btn {
    background: #007bff;
    color: white;
    border: none;
    padding: 8px 12px;
    cursor: pointer;
    border-radius: 4px;
  }
  .btn:hover {
    background: #0056b3;
  }
  .btn.secondary {
    background: #444;
    margin-top: 10px;
    margin-right: 5px;
  }
  .result-box {
    max-width: 400px;
    margin: 20px auto;
    text-align: center;
  }
  .password-display {
    background: #eee;
    padding: 10px;
    border-radius: 6px;
    font-family: monospace;
    font-size: 1.1em;
    word-break: break-all;
    margin-bottom: 10px;
  }
</style>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const copyBtn = document.getElementById('copyBtn');
  const regenBtn = document.getElementById('regenBtn');
  const pwEl = document.getElementById('password');

  if (copyBtn) {
    copyBtn.addEventListener('click', async () => {
      try {
        await navigator.clipboard.writeText(pwEl.textContent);
        copyBtn.textContent = 'Copied!';
        setTimeout(() => copyBtn.textContent = 'Copy to Clipboard', 1400);
      } catch {
        copyBtn.textContent = 'Copy Failed';
      }
    });
  }

  if (regenBtn) {
    regenBtn.addEventListener('click', () => {
      document.querySelector('.password-form').submit();
    });
  }
});
</script>
{% endblock %}
